version: '3.9'
services:

  triton:
    image: nvcr.io/nvidia/tritonserver:24.03-py3
    command: >
      tritonserver --model-repository=/models --http-port=8081
    volumes:
      - /srv/models:/models          # путь к вашим весам
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: [gpu]

  ml-gateway:
    build:
      context: ./ml-gateway-app         # путь к Dockerfile
    environment:
      TRITON_HTTP: http://triton:8081
    depends_on: [triton]
    ports:
      - "8080:80"                   # наружу
